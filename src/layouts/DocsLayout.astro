---
import Header from '@components/Header.svelte'
import Sidebar from '@components/Sidebar.svelte'
import TableOfContents from '@components/TableOfContents.svelte'
import '../styles/custom.css'

interface Props {
  title: string
  description: string
}

const { title, description } = Astro.props
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
    <meta name="description" content={description} />

    <!-- Theme initialization script - must run before any content renders -->
    <script is:inline>
      const setTheme = () => {
        const theme = localStorage.getItem('theme') ?? 'system'
        const isDark = theme === 'dark' ||
          (theme === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches)

        document.documentElement.classList[isDark ? 'add' : 'remove']('dark')
        return theme
      }

      // Set initial theme
      setTheme()

      // Handle system theme changes
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
        if (localStorage.getItem('theme') !== 'system') return
        setTheme()
      })
    </script>
  </head>
  <body class="min-h-screen bg-[#FAFAFB] dark:bg-gray-900">
    <Header client:load />

    <div class="flex h-[calc(100vh-3.5rem)] mt-14">
      <!-- Left Sidebar -->
      <aside class="fixed top-14 left-0 z-40 w-64 h-[calc(100vh-3.5rem)] border-r border-[#EDEDF0] bg-white dark:bg-gray-900 dark:border-gray-800 lg:translate-x-0 transform -translate-x-full transition-transform duration-200 ease-in-out" id="left-sidebar">
        <Sidebar client:load />
      </aside>

      <!-- Main content -->
      <div class="flex-1 w-full lg:pl-64 lg:pr-64">
        <main class="max-w-4xl mx-auto px-4 lg:px-8 py-6 lg:py-12">
          <slot />
        </main>
      </div>

      <!-- Right Sidebar -->
      <aside class="fixed top-14 right-0 z-40 w-64 h-[calc(100vh-3.5rem)] border-l border-[#EDEDF0] bg-[#FAFAFB] dark:bg-gray-900 dark:border-gray-800 lg:translate-x-0 transform translate-x-full transition-transform duration-200 ease-in-out" id="right-sidebar">
        <TableOfContents client:load />
      </aside>
    </div>
  </body>
</html>